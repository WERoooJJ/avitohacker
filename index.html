<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>MarketPlace ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="page">
<header class="header header--glass">
  <div class="container nav-wrap">
    <nav class="nav">
      <a class="nav__brand" href="index.html">MarketPlace</a>
      <div class="nav__links">
        <a href="#" class="active" data-view="feed">–õ–µ–Ω—Ç–∞</a>
        <a href="#" data-view="fav">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
        <a href="#" data-view="post" class="muted" title="–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å</a>
        <span class="divider"></span>
        <span class="balance" id="balance">–ë–∞–ª–∞–Ω—Å: ‚Äî</span>
        <span class="user" id="username">‚Äî</span>
        <a id="logoutBtn" class="btn btn--ghost" href="javascript:void(0)">–í—ã–π—Ç–∏</a>
      </div>
    </nav>
  </div>
</header>

<main class="container">
  <section id="view-feed" class="view card card--soft reveal">
    <h2>–û–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
    <div id="feed" class="grid grid--3"></div>
  </section>

  <section id="view-fav" class="view card card--soft reveal" hidden>
    <h2>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
    <div id="favList" class="grid grid--3"></div>
  </section>

  <section id="view-post" class="view card card--soft reveal" hidden>
    <h2>–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
    <div id="myAds" class="grid grid--2"></div>
  </section>
</main>

<footer class="footer">
  <div class="container footer__grid">
    <div class="footer__brand">¬© 2025 MarketPlace</div>
    <div class="footer__links">
      <a href="#" data-view="feed">–õ–µ–Ω—Ç–∞</a>
      <a href="#" data-view="fav">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
      <a href="#" data-view="post">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å</a>
    </div>
  </div>
</footer>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
<div id="auth" class="modal" hidden>
  <div class="modal__box card">
    <h2>–í—Ö–æ–¥ –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <div class="grid" style="grid-template-columns:1fr 1fr; gap:14px">
      <div>
        <label class="lbl">–õ–æ–≥–∏–Ω</label>
        <input id="authLogin" class="inp" autocomplete="username" spellcheck="false">
      </div>
      <div>
        <label class="lbl">–ü–∞—Ä–æ–ª—å</label>
        <input id="authPass" class="inp" type="password" autocomplete="current-password">
      </div>
    </div>
    <div class="row" style="margin-top:14px">
      <button class="btn" id="btnSignIn">–í–æ–π—Ç–∏</button>
      <button class="btn btn--ghost" id="btnSignUp">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </div>
  </div>
</div>

<!-- –ü–æ–±–µ–¥–Ω–∞—è –º–æ–¥–∞–ª–∫–∞ -->
<div id="win" class="win" hidden>
  <div class="win__box card" style="text-align:center">
    <h2>–ú–æ–ª–æ–¥–µ—Ü! –¢—ã –≤–∑–ª–æ–º–∞–ª —Å–∞–π—Ç ‚Ññ2 üéâ</h2>
    <p>–ü–æ–∫—É–ø–∫–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞ –ø–æ –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–π —Ü–µ–Ω–µ.</p>
    <button class="btn" onclick="closeWin()">–û–∫</button>
  </div>
</div>

<script src="app.js"></script>
<script>
  initStore();                   // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
  guardOnIndex();                // –µ—Å–ª–∏ –Ω–µ—Ç —Å–µ—Å—Å–∏–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É
  mountUI();                     // –ø–µ—Ä–≤–∏—á–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞

  document.querySelectorAll('[data-view]').forEach(a=>{
    a.addEventListener('click', (e)=>{
      e.preventDefault();
      const v = a.getAttribute('data-view');
      showView(v);
    });
  });

  document.getElementById('logoutBtn').onclick = ()=>{
    logout();
    location.reload();
  };

  // –º–æ–¥–∞–ª–∫–∞ –ª–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  const auth = document.getElementById('auth');
  document.getElementById('btnSignIn').onclick = async ()=>{
    const u = authLogin.value.trim();
    const p = authPass.value;
    const ok = await login(u, p);
    if(ok){ auth.hidden = true; mountUI(); } else { toast('–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'); }
  };
  document.getElementById('btnSignUp').onclick = async ()=>{
    const u = authLogin.value.trim();
    const p = authPass.value;
    const ok = await signup(u, p);
    if(ok){ auth.hidden = true; mountUI(); } else { toast('–¢–∞–∫–æ–π –ª–æ–≥–∏–Ω —É–∂–µ –µ—Å—Ç—å'); }
  };

  // Enter = –≤–æ–π—Ç–∏
  document.getElementById('authPass').addEventListener('keydown', e=>{
    if(e.key==='Enter') document.getElementById('btnSignIn').click();
  });

  // –µ—Å–ª–∏ —Ü–µ–Ω–∞ –º–µ–Ω—è–ª–∞—Å—å (–ø–æ—Å–ª–µ ¬´–≤–∑–ª–æ–º–∞¬ª) ‚Äî –ø–µ—Ä–µ—á–µ—Ä—á–∏–≤–∞–µ–º
  window.addEventListener('focus', mountUI);
</script>
</body>
</html>
